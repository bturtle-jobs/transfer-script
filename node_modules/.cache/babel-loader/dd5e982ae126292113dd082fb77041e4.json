{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Projects\\\\Trunks\\\\OWP-GIT\\\\owp-fe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _objectSpread from \"C:\\\\Projects\\\\Trunks\\\\OWP-GIT\\\\owp-fe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"C:\\\\Projects\\\\Trunks\\\\OWP-GIT\\\\owp-fe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"C:\\\\Projects\\\\Trunks\\\\OWP-GIT\\\\owp-fe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Projects\\\\Trunks\\\\OWP-GIT\\\\owp-fe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Projects\\\\Trunks\\\\OWP-GIT\\\\owp-fe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"C:\\\\Projects\\\\Trunks\\\\OWP-GIT\\\\owp-fe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Projects\\\\Trunks\\\\OWP-GIT\\\\owp-fe\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\n\nvar _jsxFileName = \"C:\\\\Projects\\\\Trunks\\\\OWP-GIT\\\\owp-fe\\\\node_modules\\\\owp\\\\src\\\\wrapper\\\\OwpSearchForm2.js\",\n    _this3 = this;\n\nimport { Button, withStyles } from '@material-ui/core';\nimport ClearAllIcon from '@material-ui/icons/ClearAll';\nimport SearchIcon from '@material-ui/icons/Search';\nimport classNames from 'classnames';\nimport Formsy from 'formsy-react';\nimport { isPlainObject, mapKeys, throttle } from 'lodash';\nimport FuseAnimate from 'owp/@fuse/components/FuseAnimate/FuseAnimate';\nimport { query, queryAll } from 'owp/api';\nimport { getAccessToken } from 'owp/auth';\nimport store from 'owp/store';\nimport { resetAutoComplate } from 'owp/store/actions/owp';\nimport PropTypes from 'prop-types';\nimport React, { Component } from 'react';\n\nvar _dispatch = throttle(function (action) {\n  store.dispatch(action);\n}, 1000);\n\nvar propTypes = {\n  isReady: PropTypes.bool,\n  url: PropTypes.string,\n  urls: PropTypes.arrayOf(PropTypes.string),\n  showResetButton: PropTypes.bool,\n  onSubmit: PropTypes.func,\n  onReset: PropTypes.func,\n  onError: PropTypes.func,\n  onSearchClick: PropTypes.func,\n  forwaredRef: PropTypes.func,\n  afterMapping: PropTypes.func\n};\nvar defaultProps = {\n  isReady: true,\n  showResetButton: true,\n  onSubmit: function onSubmit() {},\n  onReset: function onReset() {},\n  onError: function onError() {},\n  onSearchClick: function onSearchClick(event) {}\n};\n\nvar styles = function styles(theme) {\n  return {\n    root: {},\n    button: {\n      margin: theme.spacing.unit,\n      whiteSpace: 'noWrap'\n    },\n    leftIcon: {\n      marginRight: theme.spacing.unit\n    },\n    rightIcon: {\n      marginLeft: theme.spacing.unit\n    },\n    iconSmall: {\n      fontSize: 16\n    }\n  };\n};\n\nvar OwpSearchForm2 = /*#__PURE__*/function (_Component) {\n  _inherits(OwpSearchForm2, _Component);\n\n  var _super = _createSuper(OwpSearchForm2);\n\n  function OwpSearchForm2() {\n    var _this;\n\n    _classCallCheck(this, OwpSearchForm2);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _this.getAccessToken = function () {\n      return getAccessToken();\n    };\n\n    _this.submit = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n        var jsonData, _data;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (typeof _this.props.afterMapping === 'function') {\n                  data = _this.props.afterMapping(data);\n                }\n\n                if (!(!_this.props.url && !_this.props.urls)) {\n                  _context.next = 4;\n                  break;\n                }\n\n                _this.props.onSubmit(data);\n\n                return _context.abrupt(\"return\");\n\n              case 4:\n                jsonData = Object.entries(data).reduce(function (obj, _ref2) {\n                  var _ref3 = _slicedToArray(_ref2, 2),\n                      rootKey = _ref3[0],\n                      value = _ref3[1];\n\n                  if (isPlainObject(value)) {\n                    var newItem = mapKeys(value, function (_, key) {\n                      return \"\".concat(rootKey, \".\").concat(key);\n                    });\n                    obj = _objectSpread(_objectSpread({}, obj), newItem);\n                  }\n\n                  return obj;\n                }, {});\n                jsonData.VER = '2';\n                _context.prev = 6;\n\n                if (!_this.props.url) {\n                  _context.next = 13;\n                  break;\n                }\n\n                _context.next = 10;\n                return query({\n                  url: _this.props.url,\n                  params: {\n                    jsondata: JSON.stringify(jsonData),\n                    TOKEN: _this.getAccessToken()\n                  }\n                });\n\n              case 10:\n                _context.t0 = _context.sent;\n                _context.next = 16;\n                break;\n\n              case 13:\n                _context.next = 15;\n                return queryAll(_this.props.urls.map(function (url) {\n                  return {\n                    url: url,\n                    params: {\n                      jsondata: JSON.stringify(jsonData),\n                      TOKEN: _this.getAccessToken()\n                    }\n                  };\n                }));\n\n              case 15:\n                _context.t0 = _context.sent;\n\n              case 16:\n                _data = _context.t0;\n\n                _this.props.onSubmit(_data);\n\n                _context.next = 23;\n                break;\n\n              case 20:\n                _context.prev = 20;\n                _context.t1 = _context[\"catch\"](6);\n\n                _this.props.onError(_context.t1);\n\n              case 23:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[6, 20]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.reset = function () {\n      _this.props.onReset();\n\n      _dispatch(resetAutoComplate(true));\n    };\n\n    _this.submitFormManually = function () {\n      if (_this.form) {\n        _this.form.submit();\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(OwpSearchForm2, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (typeof this.props.forwaredRef === 'function') {\n        this.props.forwaredRef(this);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          classes = _this$props.classes,\n          isReady = _this$props.isReady;\n      return /*#__PURE__*/React.createElement(Formsy, {\n        ref: function ref(_ref4) {\n          return _this2.form = _ref4;\n        },\n        mapping: this.props.mapping,\n        onSubmit: this.submit,\n        className: \"flex flex1 w-full items-center justify-between\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"items-end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 17\n        }\n      }, this.props.children), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"flex items-end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"flex items-end\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(FuseAnimate, {\n        animation: \"transition.slideRightIn\",\n        delay: 300,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        variant: \"outlined\",\n        className: classes.button,\n        type: \"submit\",\n        disabled: !isReady,\n        onClick: this.props.onSearchClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(SearchIcon, {\n        className: classNames(classes.leftIcon, classes.iconSmall),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 33\n        }\n      }), \"\\uAC80\\xA0\\xA0\\xA0\\uC0C9\")), this.props.showResetButton && /*#__PURE__*/React.createElement(FuseAnimate, {\n        animation: \"transition.slideRightIn\",\n        delay: 300,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        variant: \"outlined\",\n        className: classes.button,\n        onClick: this.props.onReset,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(ClearAllIcon, {\n        className: classNames(classes.leftIcon, classes.iconSmall),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 37\n        }\n      }), \"\\uCD08\\uAE30\\uD654\")), /*#__PURE__*/React.createElement(\"input\", {\n        type: \"submit\",\n        className: \"hidden\",\n        ref: function ref(component) {\n          _this2.myButton = component;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167,\n          columnNumber: 25\n        }\n      }))));\n    }\n  }]);\n\n  return OwpSearchForm2;\n}(Component);\n\nOwpSearchForm2.propTypes = propTypes;\nOwpSearchForm2.defaultProps = defaultProps;\nvar StyledOwpSearchForm = withStyles(styles, {\n  withTheme: true\n})(OwpSearchForm2);\nexport default React.forwardRef(function (props, ref) {\n  return /*#__PURE__*/React.createElement(StyledOwpSearchForm, Object.assign({}, props, {\n    forwaredRef: ref,\n    __self: _this3,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 5\n    }\n  }));\n});","map":{"version":3,"sources":["C:/Projects/Trunks/OWP-GIT/owp-fe/node_modules/owp/src/wrapper/OwpSearchForm2.js"],"names":["Button","withStyles","ClearAllIcon","SearchIcon","classNames","Formsy","isPlainObject","mapKeys","throttle","FuseAnimate","query","queryAll","getAccessToken","store","resetAutoComplate","PropTypes","React","Component","_dispatch","action","dispatch","propTypes","isReady","bool","url","string","urls","arrayOf","showResetButton","onSubmit","func","onReset","onError","onSearchClick","forwaredRef","afterMapping","defaultProps","event","styles","theme","root","button","margin","spacing","unit","whiteSpace","leftIcon","marginRight","rightIcon","marginLeft","iconSmall","fontSize","OwpSearchForm2","submit","data","props","jsonData","Object","entries","reduce","obj","rootKey","value","newItem","_","key","VER","params","jsondata","JSON","stringify","TOKEN","map","reset","submitFormManually","form","classes","ref","mapping","children","component","myButton","StyledOwpSearchForm","withTheme","forwardRef"],"mappings":"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","sourcesContent":["import { Button, withStyles } from '@material-ui/core';\r\nimport ClearAllIcon from '@material-ui/icons/ClearAll';\r\nimport SearchIcon from '@material-ui/icons/Search';\r\nimport classNames from 'classnames';\r\nimport Formsy from 'formsy-react';\r\nimport { isPlainObject, mapKeys, throttle } from 'lodash';\r\nimport FuseAnimate from 'owp/@fuse/components/FuseAnimate/FuseAnimate';\r\nimport { query, queryAll } from 'owp/api';\r\nimport { getAccessToken } from 'owp/auth';\r\nimport store from 'owp/store';\r\nimport { resetAutoComplate } from 'owp/store/actions/owp';\r\nimport PropTypes from 'prop-types';\r\nimport React, { Component } from 'react';\r\n\r\nconst _dispatch = throttle((action) => {\r\n    store.dispatch(action);\r\n}, 1000);\r\n\r\nconst propTypes = {\r\n    isReady: PropTypes.bool,\r\n    url: PropTypes.string,\r\n    urls: PropTypes.arrayOf(PropTypes.string),\r\n    showResetButton: PropTypes.bool,\r\n    onSubmit: PropTypes.func,\r\n    onReset: PropTypes.func,\r\n    onError: PropTypes.func,\r\n    onSearchClick: PropTypes.func,\r\n    forwaredRef: PropTypes.func,\r\n    afterMapping: PropTypes.func,\r\n};\r\n\r\nconst defaultProps = {\r\n    isReady: true,\r\n    showResetButton: true,\r\n    onSubmit: () => {},\r\n    onReset: () => {},\r\n    onError: () => {},\r\n    onSearchClick: (event) => {},\r\n};\r\n\r\nconst styles = (theme) => ({\r\n    root: {},\r\n    button: {\r\n        margin: theme.spacing.unit,\r\n        whiteSpace: 'noWrap',\r\n    },\r\n    leftIcon: {\r\n        marginRight: theme.spacing.unit,\r\n    },\r\n    rightIcon: {\r\n        marginLeft: theme.spacing.unit,\r\n    },\r\n    iconSmall: {\r\n        fontSize: 16,\r\n    },\r\n});\r\n\r\nclass OwpSearchForm2 extends Component {\r\n    getAccessToken = () => {\r\n        return getAccessToken();\r\n    };\r\n\r\n    submit = async (data) => {\r\n        if (typeof this.props.afterMapping === 'function') {\r\n            data = this.props.afterMapping(data);\r\n        }\r\n\r\n        if (!this.props.url && !this.props.urls) {\r\n            this.props.onSubmit(data);\r\n            return;\r\n        }\r\n\r\n        const jsonData = Object.entries(data).reduce((obj, [rootKey, value]) => {\r\n            if (isPlainObject(value)) {\r\n                const newItem = mapKeys(value, (_, key) => {\r\n                    return `${rootKey}.${key}`;\r\n                });\r\n                obj = { ...obj, ...newItem };\r\n            }\r\n            return obj;\r\n        }, {});\r\n        jsonData.VER = '2';\r\n\r\n        try {\r\n            const data = !!this.props.url\r\n                ? await query({\r\n                      url: this.props.url,\r\n                      params: {\r\n                          jsondata: JSON.stringify(jsonData),\r\n                          TOKEN: this.getAccessToken(),\r\n                      },\r\n                  })\r\n                : await queryAll(\r\n                      this.props.urls.map((url) => ({\r\n                          url,\r\n                          params: {\r\n                              jsondata: JSON.stringify(jsonData),\r\n                              TOKEN: this.getAccessToken(),\r\n                          },\r\n                      }))\r\n                  );\r\n\r\n            this.props.onSubmit(data);\r\n        } catch (error) {\r\n            this.props.onError(error);\r\n        }\r\n    };\r\n\r\n    reset = () => {\r\n        this.props.onReset();\r\n        _dispatch(resetAutoComplate(true));\r\n    };\r\n\r\n    submitFormManually = () => {\r\n        if (this.form) {\r\n            this.form.submit();\r\n        }\r\n    };\r\n\r\n    componentDidMount() {\r\n        if (typeof this.props.forwaredRef === 'function') {\r\n            this.props.forwaredRef(this);\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const { classes, isReady } = this.props;\r\n\r\n        return (\r\n            <Formsy\r\n                ref={(ref) => (this.form = ref)}\r\n                mapping={this.props.mapping}\r\n                onSubmit={this.submit}\r\n                className=\"flex flex1 w-full items-center justify-between\"\r\n            >\r\n                <div className=\"items-end\">{this.props.children}</div>\r\n                <div className=\"flex items-end\">\r\n                    <div className=\"flex items-end\">\r\n                        <FuseAnimate animation=\"transition.slideRightIn\" delay={300}>\r\n                            <Button\r\n                                variant=\"outlined\"\r\n                                className={classes.button}\r\n                                type=\"submit\"\r\n                                disabled={!isReady}\r\n                                onClick={this.props.onSearchClick}\r\n                            >\r\n                                <SearchIcon\r\n                                    className={classNames(classes.leftIcon, classes.iconSmall)}\r\n                                />\r\n                                검&nbsp;&nbsp;&nbsp;색\r\n                            </Button>\r\n                        </FuseAnimate>\r\n                        {this.props.showResetButton && (\r\n                            <FuseAnimate animation=\"transition.slideRightIn\" delay={300}>\r\n                                <Button\r\n                                    variant=\"outlined\"\r\n                                    className={classes.button}\r\n                                    onClick={this.props.onReset}\r\n                                >\r\n                                    <ClearAllIcon\r\n                                        className={classNames(classes.leftIcon, classes.iconSmall)}\r\n                                    />\r\n                                    초기화\r\n                                </Button>\r\n                            </FuseAnimate>\r\n                        )}\r\n                        <input\r\n                            type=\"submit\"\r\n                            className=\"hidden\"\r\n                            ref={(component) => {\r\n                                this.myButton = component;\r\n                            }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </Formsy>\r\n        );\r\n    }\r\n}\r\n\r\nOwpSearchForm2.propTypes = propTypes;\r\nOwpSearchForm2.defaultProps = defaultProps;\r\n\r\nconst StyledOwpSearchForm = withStyles(styles, { withTheme: true })(OwpSearchForm2);\r\n\r\nexport default React.forwardRef((props, ref) => (\r\n    <StyledOwpSearchForm {...props} forwaredRef={ref} />\r\n));\r\n"]},"metadata":{},"sourceType":"module"}